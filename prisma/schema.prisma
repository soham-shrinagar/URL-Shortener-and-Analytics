generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Url {
  id           Int         @id @default(autoincrement())
  shortCode    String      @unique @map("short_code") @db.VarChar(10)
  longUrl      String      @map("long_url") @db.Text
  userId       Int?        @map("user_id")
  customAlias  String?     @unique @map("custom_alias") @db.VarChar(50)
  createdAt    DateTime    @default(now()) @map("created_at")
  expiresAt    DateTime?   @map("expires_at")
  clickCount   Int         @default(0) @map("click_count")

  analytics    Analytics[]

  @@map("urls")
}

model Analytics {
  id          Int      @id @default(autoincrement())
  shortCode   String   @map("short_code") @db.VarChar(10)
  clickTime   DateTime @default(now()) @map("click_time")
  ipAddress   String?  @map("ip_address") @db.VarChar(50)
  userAgent   String?  @map("user_agent") @db.VarChar(255)
  geoLocation String?  @map("geo_location") @db.VarChar(100)

  url         Url      @relation(fields: [shortCode], references: [shortCode])

  @@index([shortCode])
  @@index([clickTime])
  @@map("analytics")
}
